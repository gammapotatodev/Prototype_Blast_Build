window.__require=function e(t,r,o){function i(s,c){if(!r[s]){if(!t[s]){var l=s.split("/");if(l=l[l.length-1],!t[l]){var a="function"==typeof __require&&__require;if(!c&&a)return a(l,!0);if(n)return n(l,!0);throw new Error("Cannot find module '"+s+"'")}s=l}var p=r[s]={exports:{}};t[s][0].call(p.exports,function(e){return i(t[s][1][e]||e)},p,p.exports,e,t,r,o)}return r[s].exports}for(var n="function"==typeof __require&&__require,s=0;s<o.length;s++)i(o[s]);return i}({BombSystem:[function(e,t,r){"use strict";cc._RF.push(t,"519ceoftLNGCK1n/t8+7qn6","BombSystem");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),n=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(r,"__esModule",{value:!0}),r.BombSystem=void 0;var s=e("../Management/EventManager"),c=e("../Management/Events"),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.radius=1,t.destroyAll=!1,t.grid=[],t}return i(t,e),t.prototype.init=function(e){this.grid=e},t.prototype.explode=function(e,t){if(this.destroyAll){for(var r=[],o=0;o<this.grid.length;o++)for(var i=0;i<this.grid[0].length;i++)r.push(this.grid[o][i]);s.EventManager.instance.emit(new c.TilesRemovedEvent(r,r.length))}else{var n=this.getCellsInRadius(e,t);s.EventManager.instance.emit(new c.TilesRemovedEvent(n,n.length))}},t.prototype.getCellsInRadius=function(e,t){for(var r=[],o=-this.radius;o<=this.radius;o++)for(var i=-this.radius;i<=this.radius;i++)if(!(Math.sqrt(o*o+i*i)>this.radius)){var n=e+o,s=t+i;if(this.isInsideGrid(n,s)){var c=this.grid[n][s];c&&c.isValid&&r.push(c)}}return r},t.prototype.isInsideGrid=function(e,t){return e>=0&&t>=0&&e<this.grid.length&&t<this.grid[0].length},n([cc._decorator.property],t.prototype,"radius",void 0),n([cc._decorator.property],t.prototype,"destroyAll",void 0),n([cc._decorator.ccclass],t)}(cc.Component);r.BombSystem=l,cc._RF.pop()},{"../Management/EventManager":"EventManager","../Management/Events":"Events"}],BoosterTeleport:[function(e,t,r){"use strict";cc._RF.push(t,"3e729WDGOlHcLBMCJJ9/pNJ","BoosterTeleport"),Object.defineProperty(r,"__esModule",{value:!0}),r.BoosterTeleport=void 0;var o=e("../TileProperties/TileSystem"),i=function(){function e(e){this.gridGenerator=e}return e.prototype.TeleportTiles=function(e,t){if(e&&t&&e!==t){var r=this.gridGenerator.gridTiles,i=e.getComponent(o.TileSystem),n=t.getComponent(o.TileSystem),s=i.row,c=i.col,l=n.row,a=n.col,p=e.position.clone(),u=t.position.clone();cc.tween(e).to(.2,{position:u}).start(),cc.tween(t).to(.2,{position:p}).start(),r[s][c]=t,r[l][a]=e,i.row=l,i.col=a,n.row=s,n.col=c}},e}();r.BoosterTeleport=i,cc._RF.pop()},{"../TileProperties/TileSystem":"TileSystem"}],ClickHandle:[function(e,t,r){"use strict";cc._RF.push(t,"0c83eBWY8JJfpUapT46+eh4","ClickHandle");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),n=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(r,"__esModule",{value:!0}),r.ClickHandle=void 0;var s=e("./EventManager"),c=e("./Events"),l=e("../TileProperties/TileSystem"),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.grid=null,t}return i(t,e),t.prototype.Init=function(e){this.grid=e,this.node.on(cc.Node.EventType.MOUSE_DOWN,this.OnClick,this)},t.prototype.OnClick=function(e){if(e.getButton()===cc.Event.EventMouse.BUTTON_LEFT){var t=this.node.getComponent(l.TileSystem),r=new c.TileClickEvent(t.row,t.col,this.node,t.groupIndex);s.EventManager.instance.emit(r)}},t.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.MOUSE_DOWN,this.OnClick,this)},n([cc._decorator.ccclass],t)}(cc.Component);r.ClickHandle=a,cc._RF.pop()},{"../TileProperties/TileSystem":"TileSystem","./EventManager":"EventManager","./Events":"Events"}],EventManager:[function(e,t,r){"use strict";cc._RF.push(t,"a0187Sx5dxNgJOawWl5GSWl","EventManager"),Object.defineProperty(r,"__esModule",{value:!0}),r.EventManager=void 0;var o=function(){function e(){this.listeners=new Map}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),e.prototype.on=function(e,t){var r="string"==typeof e?e:e.Type;this.listeners.has(r)||this.listeners.set(r,[]),this.listeners.get(r).push(t)},e.prototype.off=function(e,t){var r="string"==typeof e?e:e.Type,o=this.listeners.get(r);if(o){var i=o.indexOf(t);-1!==i&&o.splice(i,1)}},e.prototype.emit=function(e){var t=this.listeners.get(e.type);t&&t.length>0&&t.forEach(function(t){try{t(e)}catch(r){console.error('Error in event callback for event type "'+e.type+'":',r)}})},e}();r.EventManager=o,cc._RF.pop()},{}],Events:[function(e,t,r){"use strict";cc._RF.push(t,"2f1eaietQ1Fl6jECJNVFtTO","Events");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.GameOverEvent=r.RefreshGridEvent=r.UpdateUIEvent=r.TilesRemovedEvent=r.TileClickEvent=r.BaseEvent=r.GameResultType=void 0,function(e){e[e.Win=0]="Win",e[e.Lose=1]="Lose"}(r.GameResultType||(r.GameResultType={}));var n=function(e){this.type=e};r.BaseEvent=n;var s=function(e){function t(r,o,i,n){var s=e.call(this,t.Type)||this;return s.row=r,s.col=o,s.tileNode=i,s.tileGroup=n,s}return i(t,e),t.Type="TileClickEvent",t}(n);r.TileClickEvent=s;var c=function(e){function t(r,o){var i=e.call(this,t.Type)||this;return i.removedTiles=r,i.groupSize=o,i}return i(t,e),t.Type="TilesRemovedEvent",t}(n);r.TilesRemovedEvent=c;var l=function(e){function t(r,o,i,n){var s=e.call(this,t.Type)||this;return s.score=r,s.moves=o,s.bomb=i,s.teleport=n,s}return i(t,e),t.Type="UpdateUIEvent",t}(n);r.UpdateUIEvent=l;var a=function(e){function t(){return e.call(this,t.Type)||this}return i(t,e),t.Type="RefreshGridEvent",t}(n);r.RefreshGridEvent=a;var p=function(e){function t(r,o,i){var n=e.call(this,t.Type)||this;return n.resultType=r,n.score=o,n.goalScore=i,n}return i(t,e),t.Type="GameOverEvent",t}(n);r.GameOverEvent=p,cc._RF.pop()},{}],GameManager:[function(e,t,r){"use strict";cc._RF.push(t,"e6bef+u62tH1qUTHuzW1wzj","GameManager");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),n=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(r,"__esModule",{value:!0});var s=e("./EventManager"),c=e("./Events"),l=e("../GridSystem/TilesGroupSystem"),a=e("../GridSystem/GenerateGridSystem"),p=e("../GridSystem/MoveTilesSystem"),u=e("../GridSystem/GridProperties"),d=e("../GridSystem/RandomTileSystem"),h=e("./UpdateUISystem"),y=e("./RemoveTilesSystem"),f=e("./RefreshGridSystem"),v=e("../GameFeatures/BoosterTeleport"),m=e("../GameFeatures/SuperTileSystem"),g=e("../TileProperties/TileSystem"),S=e("../GameFeatures/BombSystem"),T=e("../GameFeatures/RocketSystem");(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gridNode=null,t.randomTileSystemNode=null,t.superTileSystem=null,t.gridGenerator=null,t.gridSize=null,t.randomTileSystem=null,t.tilesRemoveSystem=null,t.refreshTilesSystem=null,t.moveTiles=null,t.updateUISystem=null,t.activeBoosterTeleport=null,t.teleportFirstTile=null,t.superTile=null,t.tilesGroupSystem=new l.TilesGroupSystem,t.startMovesCount=0,t.goalScore=0,t.startBombCount=0,t.startTeleportCount=0,t.refreshesCount=0,t.isAnimating=!1,t.activeBoosterBomb=!1,t}i(t,e),t.prototype.onLoad=function(){this.updateUISystem=this.getComponent(h.UpdateUISystem),this.gridNode.active=!0,this.refreshesCount=0,this.gridGenerator=this.gridNode.getComponent(a.GridGenerator),this.gridSize=this.gridNode.getComponent(u.GridSize),this.startMovesCount=this.updateUISystem.movesCount,this.goalScore=this.updateUISystem.goalScore,this.startBombCount=this.updateUISystem.BoosterBombCount,this.startTeleportCount=this.updateUISystem.BoosterTeleportCount,this.tilesRemoveSystem=new y.RemoveTilesSystem(this.gridGenerator,this.updateUISystem,0,this.startMovesCount),this.randomTileSystem=this.randomTileSystemNode.getComponent(d.RandomTileSystem),this.superTile=this.superTileSystem.getComponent(m.SuperTileSystem),this.superTile.Init(this.gridGenerator),this.tilesGroupSystem.Init(this.gridGenerator),this.moveTiles=new p.MoveTilesSystem(this.gridGenerator,this.gridSize,this.randomTileSystem),this.refreshTilesSystem=new f.RefreshGridSystem(this.gridGenerator,this.gridSize),this.boundOnTileClick=this.onTileClick.bind(this),this.boundOnTilesRemoved=this.onTilesRemoved.bind(this),this.boundOnUpdateUI=this.onUpdateUI.bind(this),this.boundOnRefreshGrid=this.onRefreshTiles.bind(this),s.EventManager.instance.on(c.TileClickEvent,this.boundOnTileClick),s.EventManager.instance.on(c.TilesRemovedEvent,this.boundOnTilesRemoved),s.EventManager.instance.on(c.UpdateUIEvent,this.boundOnUpdateUI),s.EventManager.instance.on(c.RefreshGridEvent,this.boundOnRefreshGrid)},t.prototype.onTileClick=function(e){var t=this;if(!this.isAnimating){var r=this.gridGenerator.gridTiles[e.row][e.col];if(r.getComponent(g.TileSystem).isSuperTile){this.isAnimating=!0;var o=r.getComponent(S.BombSystem),i=r.getComponent(T.RocketSystem);return o?(o.init(this.gridGenerator.gridTiles),o.explode(e.row,e.col)):i&&(i.init(this.gridGenerator.gridTiles),i.explode(e.row,e.col)),void this.scheduleOnce(function(){t.moveTiles.ApplyMove(),t.isAnimating=!1},.3)}if(this.activeBoosterTeleport&&this.startTeleportCount>0)return this.teleportFirstTile?(this.isAnimating=!0,this.activeBoosterTeleport.TeleportTiles(this.teleportFirstTile,r),this.teleportFirstTile=null,this.activeBoosterTeleport=null,this.tilesGroupSystem.Init(this.gridGenerator),this.scheduleOnce(function(){t.isAnimating=!1},.2),this.startTeleportCount--,void s.EventManager.instance.emit(new c.UpdateUIEvent(this.tilesRemoveSystem.Score,this.tilesRemoveSystem.Moves,this.startBombCount,this.startTeleportCount))):void(this.teleportFirstTile=r);if(this.activeBoosterBomb&&this.startBombCount>0){this.isAnimating=!0;var n=new cc.Node;return(o=n.addComponent(S.BombSystem)).radius=1,o.init(this.gridGenerator.gridTiles),o.explode(e.row,e.col),n.destroy(),this.activeBoosterBomb=!1,this.startBombCount--,void s.EventManager.instance.emit(new c.UpdateUIEvent(this.tilesRemoveSystem.Score,this.tilesRemoveSystem.Moves,this.startBombCount,this.startTeleportCount))}var l=this.tilesGroupSystem.FindConnectedTilesGroup(e.row,e.col,e.tileGroup);if(l.length>=5){this.isAnimating=!0;var a=this.gridGenerator.gridTiles[e.row][e.col];return this.tilesRemoveSystem.RemoveTilesWithoutScore(l),this.superTile.SpawnSuperTile(a),this.tilesGroupSystem.Init(this.gridGenerator),void this.scheduleOnce(function(){t.moveTiles.ApplyMove(),t.isAnimating=!1},.3)}l.length>=2&&s.EventManager.instance.emit(new c.TilesRemovedEvent(l,l.length)),this.tilesGroupSystem.HasAnyMoves()||(this.refreshesCount++,s.EventManager.instance.emit(new c.RefreshGridEvent))}},t.prototype.onUpdateUI=function(e){this.updateUISystem.UpdateUI(e.score,e.moves,e.bomb,e.teleport)},t.prototype.onTilesRemoved=function(e){var t=this;this.isAnimating=!0,this.tilesRemoveSystem.RemoveTiles(e.removedTiles),s.EventManager.instance.emit(new c.UpdateUIEvent(this.tilesRemoveSystem.Score,this.tilesRemoveSystem.Moves,this.startBombCount,this.startTeleportCount)),this.CheckGameOver(this.tilesRemoveSystem.Score,this.tilesRemoveSystem.Moves),this.scheduleOnce(function(){t.moveTiles.ApplyMove(),t.isAnimating=!1},.3)},t.prototype.onRefreshTiles=function(){var e=this;this.refreshesCount>3?s.EventManager.instance.emit(new c.GameOverEvent(c.GameResultType.Lose,this.tilesRemoveSystem.Score,this.goalScore)):(this.isAnimating=!0,this.refreshTilesSystem.RefreshGrid(),this.tilesGroupSystem.Init(this.gridGenerator),this.scheduleOnce(function(){e.isAnimating=!1},.5))},t.prototype.CheckGameOver=function(e,t){e>=this.goalScore?(s.EventManager.instance.emit(new c.GameOverEvent(c.GameResultType.Win,e,this.goalScore)),this.gridNode.active=!1):t<=0&&(s.EventManager.instance.emit(new c.GameOverEvent(c.GameResultType.Lose,e,this.goalScore)),this.gridNode.active=!1)},t.prototype.RestartGame=function(){cc.director.loadScene(cc.director.getScene().name)},t.prototype.DebugRefreshGrid=function(){this.refreshesCount<3?(this.refreshesCount++,s.EventManager.instance.emit(new c.RefreshGridEvent)):this.refreshesCount>=3&&s.EventManager.instance.emit(new c.GameOverEvent(c.GameResultType.Lose,this.tilesRemoveSystem.Score,this.goalScore))},t.prototype.ActivateBomb=function(){this.activeBoosterBomb||(this.activeBoosterBomb=!0)},t.prototype.ActivateTeleport=function(){this.activeBoosterTeleport||(this.activeBoosterTeleport=new v.BoosterTeleport(this.gridGenerator),this.teleportFirstTile=null)},t.prototype.onDestroy=function(){s.EventManager.instance.off(c.TileClickEvent,this.boundOnTileClick),s.EventManager.instance.off(c.TilesRemovedEvent,this.boundOnTilesRemoved),s.EventManager.instance.off(c.UpdateUIEvent,this.boundOnUpdateUI),s.EventManager.instance.off(c.RefreshGridEvent,this.boundOnRefreshGrid)},n([cc._decorator.property(cc.Node)],t.prototype,"gridNode",void 0),n([cc._decorator.property(cc.Node)],t.prototype,"randomTileSystemNode",void 0),n([cc._decorator.property(cc.Node)],t.prototype,"superTileSystem",void 0),t=n([cc._decorator.ccclass],t)})(cc.Component),cc._RF.pop()},{"../GameFeatures/BombSystem":"BombSystem","../GameFeatures/BoosterTeleport":"BoosterTeleport","../GameFeatures/RocketSystem":"RocketSystem","../GameFeatures/SuperTileSystem":"SuperTileSystem","../GridSystem/GenerateGridSystem":"GenerateGridSystem","../GridSystem/GridProperties":"GridProperties","../GridSystem/MoveTilesSystem":"MoveTilesSystem","../GridSystem/RandomTileSystem":"RandomTileSystem","../GridSystem/TilesGroupSystem":"TilesGroupSystem","../TileProperties/TileSystem":"TileSystem","./EventManager":"EventManager","./Events":"Events","./RefreshGridSystem":"RefreshGridSystem","./RemoveTilesSystem":"RemoveTilesSystem","./UpdateUISystem":"UpdateUISystem"}],GameOverSystem:[function(e,t,r){"use strict";cc._RF.push(t,"99a51NgVrNJ+7sN/Nyz6obl","GameOverSystem");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),n=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(r,"__esModule",{value:!0}),r.GameOverSystem=void 0;var s=e("./EventManager"),c=e("./Events"),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.resultScreen=null,t.mainTextLabel=null,t.WinScoreLabel=null,t.loseScoreLabel=null,t}return i(t,e),t.prototype.onLoad=function(){this.resultScreen.active=!1,this.WinScoreLabel.node.active=!1,this.loseScoreLabel.node.active=!1,this.boundOnGameOver=this.onGameOver.bind(this),s.EventManager.instance.on(c.GameOverEvent.Type,this.boundOnGameOver)},t.prototype.onGameOver=function(e){switch(e.resultType){case c.GameResultType.Win:this.mainTextLabel.string="\u041f\u041e\u0411\u0415\u0414\u0418\u041b!",this.WinScoreLabel.node.active=!0,this.WinScoreLabel.string="\u0422\u044b \u043d\u0430\u0431\u0440\u0430\u043b \u043d\u0443\u0436\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e\n\u043e\u0447\u043a\u043e\u0432, \u043c\u043e\u043b\u043e\u0434\u0435\u0446!";break;case c.GameResultType.Lose:this.mainTextLabel.string="\u041f\u0420\u041e\u0418\u0413\u0420\u0410\u041b!",this.loseScoreLabel.node.active=!0,this.loseScoreLabel.string="\u0422\u0432\u043e\u0438 \u043e\u0447\u043a\u0438: "+e.score.toString()+" / "+e.goalScore.toString()}this.resultScreen.active=!0},t.prototype.onDestroy=function(){s.EventManager.instance.off(c.GameOverEvent.Type,this.boundOnGameOver)},n([cc._decorator.property(cc.Node)],t.prototype,"resultScreen",void 0),n([cc._decorator.property(cc.Label)],t.prototype,"mainTextLabel",void 0),n([cc._decorator.property(cc.Label)],t.prototype,"WinScoreLabel",void 0),n([cc._decorator.property(cc.Label)],t.prototype,"loseScoreLabel",void 0),n([cc._decorator.ccclass],t)}(cc.Component);r.GameOverSystem=l,cc._RF.pop()},{"./EventManager":"EventManager","./Events":"Events"}],GenerateGridSystem:[function(e,t,r){"use strict";cc._RF.push(t,"1e271zhaOZEVat68OeF3nPc","GenerateGridSystem");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),n=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(r,"__esModule",{value:!0}),r.GridGenerator=void 0;var s=e("./GridProperties"),c=e("./GridProperties"),l=e("../Management/ClickHandle"),a=e("../TileProperties/TileSystem"),p=e("./RandomTileSystem"),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gridNode=null,t.randomTileSystemComponent=null,t.calculation=new c.CalculationProperties,t.gridTiles=[],t}return i(t,e),t.prototype.start=function(){var e=this.gridNode.getComponent(s.GridSize).getGridSize(),t=this.calculation.CalculateGridProperties(e);this.GenerateGrid(e.width,e.height,e.cellSize,t.startX,t.startY)},t.prototype.GenerateGrid=function(e,t,r,o,i){this.gridTiles=[];for(var n=0;n<t;n++){this.gridTiles[n]=[];for(var s=0;s<e;s++){var c=this.randomTileSystemComponent.getRandomTile(),p=c.prefab,u=c.index,d=cc.instantiate(p);d.setPosition(o+s*r,i+n*r),this.gridNode.addChild(d),this.gridTiles[n][s]=d;var h=d.getComponent(a.TileSystem);h.row=n,h.col=s,h.groupIndex=u,d.addComponent(l.ClickHandle).Init(this)}}},n([cc._decorator.property(cc.Node)],t.prototype,"gridNode",void 0),n([cc._decorator.property(p.RandomTileSystem)],t.prototype,"randomTileSystemComponent",void 0),n([cc._decorator.ccclass],t)}(cc.Component);r.GridGenerator=u,cc._RF.pop()},{"../Management/ClickHandle":"ClickHandle","../TileProperties/TileSystem":"TileSystem","./GridProperties":"GridProperties","./RandomTileSystem":"RandomTileSystem"}],GridProperties:[function(e,t,r){"use strict";cc._RF.push(t,"11c9dyOvNVJmr+BgiLakIyL","GridProperties");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),n=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(r,"__esModule",{value:!0}),r.CalculationProperties=r.GridSize=void 0;var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gridWidth=9,t.gridHeight=9,t.gridCellSize=70,t}return i(t,e),t.prototype.getGridSize=function(){return{width:this.gridWidth,height:this.gridHeight,cellSize:this.gridCellSize}},n([cc._decorator.property(cc.Integer)],t.prototype,"gridWidth",void 0),n([cc._decorator.property(cc.Integer)],t.prototype,"gridHeight",void 0),n([cc._decorator.property(cc.Integer)],t.prototype,"gridCellSize",void 0),n([cc._decorator.ccclass],t)}(cc.Component);r.GridSize=s;var c=function(){function e(){}return e.prototype.CalculateGridProperties=function(e){return{startX:-(e.width-1)*e.cellSize/2,startY:-(e.height-1)*e.cellSize/2}},e}();r.CalculationProperties=c,cc._RF.pop()},{}],MoveTilesSystem:[function(e,t,r){"use strict";cc._RF.push(t,"2be4382wUZPh6ubW7e8BM6M","MoveTilesSystem"),Object.defineProperty(r,"__esModule",{value:!0}),r.MoveTilesSystem=void 0;var o=e("./GridProperties"),i=e("../TileProperties/TileSystem"),n=e("../Management/ClickHandle"),s=function(){function e(e,t,r){this.grid=e,this.gridSize=t,this.randomTileSystem=r,this.calcProps=new o.CalculationProperties}return e.prototype.ApplyMove=function(){for(var e=!1,t=this.grid.gridTiles.length,r=this.grid.gridTiles[0].length,o=this.gridSize.getGridSize(),n=this.calcProps.CalculateGridProperties(o),s=n.startX,c=n.startY,l=0;l<r;l++)for(var a=0,p=0;p<t;p++){var u=this.grid.gridTiles[p][l];if(null!==u){if(p!==a){this.grid.gridTiles[a][l]=u,this.grid.gridTiles[p][l]=null;var d=u.getComponent(i.TileSystem);d.row=a,d.col=l;var h=s+l*o.cellSize,y=c+a*o.cellSize;u.setPosition(h,y),e=!0}a++}}return this.AddNewTiles(),e},e.prototype.AddNewTiles=function(){for(var e=this.grid.gridTiles.length,t=this.grid.gridTiles[0].length,r=this.gridSize.getGridSize(),o=this.calcProps.CalculateGridProperties(r),s=o.startX,c=o.startY,l=0;l<t;l++)for(var a=0;a<e;a++)if(null===this.grid.gridTiles[a][l]){var p=this.randomTileSystem.getRandomTile(),u=p.prefab,d=p.index,h=cc.instantiate(u);h.setParent(this.grid.node);var y=s+l*r.cellSize,f=c+a*r.cellSize,v=2*r.cellSize;h.setPosition(y,f+v),this.grid.gridTiles[a][l]=h;var m=h.getComponent(i.TileSystem);m.row=a,m.col=l,m.groupIndex=d,h.addComponent(n.ClickHandle).Init(this.grid),cc.tween(h).to(.3,{position:cc.v3(y,f,0)},{easing:"quadIn"}).start()}},e}();r.MoveTilesSystem=s,cc._RF.pop()},{"../Management/ClickHandle":"ClickHandle","../TileProperties/TileSystem":"TileSystem","./GridProperties":"GridProperties"}],RandomTileSystem:[function(e,t,r){"use strict";cc._RF.push(t,"2bdd1ncKzhGxIdB5k5La/Mi","RandomTileSystem");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),n=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(r,"__esModule",{value:!0}),r.RandomTileSystem=void 0;var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tilePrefabs=[],t}return i(t,e),t.prototype.getRandomTile=function(){var e=Math.floor(Math.random()*this.tilePrefabs.length);return{prefab:this.tilePrefabs[e],index:e}},n([cc._decorator.property(cc.Prefab)],t.prototype,"tilePrefabs",void 0),n([cc._decorator.ccclass],t)}(cc.Component);r.RandomTileSystem=s,cc._RF.pop()},{}],RefreshGridSystem:[function(e,t,r){"use strict";cc._RF.push(t,"dd9d5I2C4pNubJiS91PzYdK","RefreshGridSystem"),Object.defineProperty(r,"__esModule",{value:!0}),r.RefreshGridSystem=void 0;var o=e("../TileProperties/TileSystem"),i=function(){function e(e,t){this.gridGenerator=e,this.gridSize=t}return e.prototype.RefreshGrid=function(){for(var e=this.gridGenerator.gridTiles,t=this.gridSize.getGridSize(),r=t.cellSize,i=-(t.width-1)*r/2,n=-(t.height-1)*r/2,s=[],c=0;c<t.height;c++)for(var l=0;l<t.width;l++)s.push(e[c][l]);for(var a=s.length-1;a>0;a--){var p=Math.floor(Math.random()*(a+1)),u=s[a];s[a]=s[p],s[p]=u}var d=0;for(c=0;c<t.height;c++)for(l=0;l<t.width;l++){var h=s[d];h.setPosition(i+l*r,n+c*r),e[c][l]=h;var y=h.getComponent(o.TileSystem);y.row=c,y.col=l,d++}},e}();r.RefreshGridSystem=i,cc._RF.pop()},{"../TileProperties/TileSystem":"TileSystem"}],RemoveTilesSystem:[function(e,t,r){"use strict";cc._RF.push(t,"5aa8cOma6hD7prXWPoXaU7E","RemoveTilesSystem"),Object.defineProperty(r,"__esModule",{value:!0}),r.RemoveTilesSystem=void 0;var o=e("../TileProperties/TileSystem"),i=function(){function e(e,t,r,o){this.gridGenerator=e,this.updateUISystem=t,this.currentScore=r,this.currentMoves=o}return e.prototype.RemoveTiles=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t],n=i.getComponent(o.TileSystem);-1!==n.row&&-1!==n.col&&(this.gridGenerator.gridTiles[n.row][n.col]=null,i.destroy())}this.currentMoves--;var s=this.updateUISystem.ScoreMultiplier*e.length;this.currentScore+=s},e.prototype.RemoveTilesWithoutScore=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t],n=i.getComponent(o.TileSystem);-1!==n.row&&-1!==n.col&&(this.gridGenerator.gridTiles[n.row][n.col]=null,i.destroy())}},Object.defineProperty(e.prototype,"Score",{get:function(){return this.currentScore},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Moves",{get:function(){return this.currentMoves},enumerable:!1,configurable:!0}),e}();r.RemoveTilesSystem=i,cc._RF.pop()},{"../TileProperties/TileSystem":"TileSystem"}],RocketSystem:[function(e,t,r){"use strict";cc._RF.push(t,"a12081Otv5CRL9fBANvY4HH","RocketSystem");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),n=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(r,"__esModule",{value:!0}),r.RocketSystem=void 0;var s=e("../Management/EventManager"),c=e("../Management/Events"),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rocketRow=!1,t.rocketCol=!1,t.grid=[],t}return i(t,e),t.prototype.init=function(e){this.grid=e},t.prototype.explode=function(e,t){if(this.grid&&0!==this.grid.length){var r=[];if(this.rocketRow)for(var o=0;o<this.grid[0].length;o++)r.push(this.grid[e][o]);if(this.rocketCol)for(var i=0;i<this.grid.length;i++)r.push(this.grid[i][t]);var n=Array.from(new Set(r));s.EventManager.instance.emit(new c.TilesRemovedEvent(n,n.length))}},n([cc._decorator.property],t.prototype,"rocketRow",void 0),n([cc._decorator.property],t.prototype,"rocketCol",void 0),n([cc._decorator.ccclass],t)}(cc.Component);r.RocketSystem=l,cc._RF.pop()},{"../Management/EventManager":"EventManager","../Management/Events":"Events"}],SuperTileSystem:[function(e,t,r){"use strict";cc._RF.push(t,"20627VV2ZBKvKW9jboduiut","SuperTileSystem");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),n=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(r,"__esModule",{value:!0}),r.SuperTileSystem=void 0;var s=e("../Management/ClickHandle"),c=e("../TileProperties/TileSystem"),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.superTilesPrefab=[],t.gridGenerator=null,t}return i(t,e),t.prototype.Init=function(e){this.gridGenerator=e},t.prototype.SpawnSuperTile=function(e){var t=Math.floor(Math.random()*this.superTilesPrefab.length),r=this.superTilesPrefab[t],o=cc.instantiate(r),i=e.getComponent(c.TileSystem);o.setPosition(e.getPosition()),e.parent.addChild(o),this.gridGenerator.gridTiles[i.row][i.col]=o;var n=o.getComponent(c.TileSystem);return n.row=i.row,n.col=i.col,n.groupIndex=-1,n.isSuperTile=!0,o.addComponent(s.ClickHandle).Init(this.gridGenerator),o},n([cc._decorator.property(cc.Prefab)],t.prototype,"superTilesPrefab",void 0),n([cc._decorator.ccclass],t)}(cc.Component);r.SuperTileSystem=l,cc._RF.pop()},{"../Management/ClickHandle":"ClickHandle","../TileProperties/TileSystem":"TileSystem"}],TileSystem:[function(e,t,r){"use strict";cc._RF.push(t,"19a83hDYzhIApgqdkh7Ftpd","TileSystem");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),n=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(r,"__esModule",{value:!0}),r.TileSystem=void 0;var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.row=0,t.col=0,t.groupIndex=0,t.isSuperTile=!1,t}return i(t,e),n([cc._decorator.ccclass],t)}(cc.Component);r.TileSystem=s,cc._RF.pop()},{}],TilesGroupSystem:[function(e,t,r){"use strict";cc._RF.push(t,"a8373nCXHFJMYJ/vbqj6Mq4","TilesGroupSystem"),Object.defineProperty(r,"__esModule",{value:!0}),r.TilesGroupSystem=void 0;var o=e("../TileProperties/TileSystem"),i=function(){function e(){this.grid=null}return e.prototype.Init=function(e){this.grid=e},e.prototype.FindConnectedTilesGroup=function(e,t,r){for(var i=[],n=[],s=0;s<this.grid.gridTiles.length;s++){i[s]=[];for(var c=0;c<this.grid.gridTiles[s].length;c++)i[s][c]=!1}for(var l=[[e,t]];l.length>0;){var a=l.pop(),p=a[0],u=a[1];p<0||p>=this.grid.gridTiles.length||u<0||u>=this.grid.gridTiles[p].length||!i[p][u]&&this.grid.gridTiles[p][u]&&this.grid.gridTiles[p][u].getComponent(o.TileSystem).groupIndex===r&&(i[p][u]=!0,n.push(this.grid.gridTiles[p][u]),l.push([p+1,u]),l.push([p-1,u]),l.push([p,u+1]),l.push([p,u-1]))}return n},e.prototype.HasAnyMoves=function(){for(var e=[],t=0;t<this.grid.gridTiles.length;t++){e[t]=[];for(var r=0;r<this.grid.gridTiles[t].length;r++)e[t][r]=!1}for(var i=0;i<this.grid.gridTiles.length;i++)for(var n=0;n<this.grid.gridTiles[i].length;n++){var s=this.grid.gridTiles[i][n];if(s&&!e[i][n]){for(var c=s.getComponent(o.TileSystem),l=this.FindConnectedTilesGroup(c.row,c.col,c.groupIndex),a=0,p=l;a<p.length;a++){var u=p[a].getComponent(o.TileSystem);e[u.row][u.col]=!0}if(l.length>=2)return!0}}return!1},e}();r.TilesGroupSystem=i,cc._RF.pop()},{"../TileProperties/TileSystem":"TileSystem"}],UpdateUISystem:[function(e,t,r){"use strict";cc._RF.push(t,"5c5dcQviGhItZzcYoOZWZ5h","UpdateUISystem");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),n=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(r,"__esModule",{value:!0}),r.UpdateUISystem=void 0;var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scoreLabel=null,t.movesLabel=null,t.bombLabel=null,t.teleportLabel=null,t.goalScore=100,t.movesCount=20,t.ScoreMultiplier=10,t.BoosterBombCount=5,t.BoosterTeleportCount=5,t}return i(t,e),t.prototype.onLoad=function(){this.scoreLabel.string=" / "+this.goalScore.toString(),this.movesLabel.string=this.movesCount.toString(),this.bombLabel.string=this.BoosterBombCount.toString(),this.teleportLabel.string=this.BoosterTeleportCount.toString()},t.prototype.UpdateUI=function(e,t,r,o){this.scoreLabel.string=e.toString()+" / "+this.goalScore.toString(),this.movesLabel.string=t.toString(),this.bombLabel.string=r.toString(),this.teleportLabel.string=o.toString()},n([cc._decorator.property(cc.Label)],t.prototype,"scoreLabel",void 0),n([cc._decorator.property(cc.Label)],t.prototype,"movesLabel",void 0),n([cc._decorator.property(cc.Label)],t.prototype,"bombLabel",void 0),n([cc._decorator.property(cc.Label)],t.prototype,"teleportLabel",void 0),n([cc._decorator.property()],t.prototype,"goalScore",void 0),n([cc._decorator.property()],t.prototype,"movesCount",void 0),n([cc._decorator.property()],t.prototype,"ScoreMultiplier",void 0),n([cc._decorator.property()],t.prototype,"BoosterBombCount",void 0),n([cc._decorator.property()],t.prototype,"BoosterTeleportCount",void 0),n([cc._decorator.ccclass],t)}(cc.Component);r.UpdateUISystem=s,cc._RF.pop()},{}]},{},["BombSystem","BoosterTeleport","RocketSystem","SuperTileSystem","GenerateGridSystem","GridProperties","MoveTilesSystem","RandomTileSystem","TilesGroupSystem","ClickHandle","EventManager","Events","GameManager","GameOverSystem","RefreshGridSystem","RemoveTilesSystem","UpdateUISystem","TileSystem"]);